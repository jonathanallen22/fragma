/* =========================================
   1. SETUP BASE & VARIABILI
   ========================================= */
:root {
    --bg-color: #010101; /* Nero assoluto per contrasto */
    --accent-color: #ff340c;
    --accent-glow: rgba(255, 72, 36, 0.5);
    --glass-bg: rgba(10, 10, 10, 0.8);
    --glass-border: rgba(255, 255, 255, 0.15);
    
    --font-hoves: 'TTHoves-Regular', sans-serif;
    --font-hoves-bold: 'TTHoves-Bold', sans-serif;
    --font-mono: 'Input-Mono', monospace;
    --font-hoves-light:'TTHoves-Light', sans-serif;
}

@font-face { font-family: 'TTHoves-Regular'; src: url('../assets/fonts/TT Hoves Pro Trial Regular.ttf') format('truetype'); }
@font-face { font-family: 'TTHoves-Bold'; src: url('../assets/fonts/TT Hoves Pro Trial Bold.ttf') format('truetype'); }
@font-face { font-family: 'Input-Mono'; src: url('../assets/fonts/input.ttf') format('truetype'); }
@font-face { font-family: 'TTHoves-Light'; src: url('../assets/fonts/TT\ Hoves\ Pro\ Trial\ Light.ttf') format('truetype'); }

html { font-size: 1vw; } 

body {
    background-color: var(--bg-color); color: white;
    font-family: var(--font-hoves); height: 100vh; width: 100vw;
    overflow: hidden; margin: 0;
}

/* =========================================
   2. UI & HEADER
   ========================================= */
.scene {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    opacity: 0; visibility: hidden; z-index: 1;
    /* RIMOSSO IL FLEXBOX GLOBALE CHE ROMPEVA IL LAYOUT */
}
.scene.active { opacity: 1; visibility: visible; z-index: 10; pointer-events: all; }
.hidden { opacity: 0 !important; pointer-events: none !important; visibility: hidden !important; }

#global-header {
    position: fixed; top: 0; left: 0; width: 100%; height: 5%; padding: 0 4rem;
    display: flex; justify-content: space-between; align-items: center;
    z-index: 100; background: linear-gradient(to bottom, rgba(0,0,0,0.9) 0%, transparent 100%);
    pointer-events: none; transition: opacity 0.5s; box-sizing: border-box;
    border-bottom: 1px solid rgba(255, 255, 255, 0.678);
}
.header-left { flex: 1; display: flex; align-items: center; gap: 1rem; }
.header-center { flex: 1; text-align: center; font-size: 1.2rem; letter-spacing: 0.2rem;  }
.header-right { flex: 1; text-align: right; font-size: 1.2rem; }
.icon-f { font-size: 2rem; color: var(--accent-color); }
.header-logo-img { height: 2rem; width: auto; filter: invert(0); }

/* =========================================
   3. SCENA INTRO (Layout Originale Ripristinato)
   ========================================= */
#scene-intro { 
    display: flex; flex-direction: column; align-items: center; 
    padding-top: 15vh; /* Spazio preciso dall'alto */
}
#canvas-container-intro { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }

/* Il contenuto deve stare SOPRA il canvas 3D */
.intro-top { z-index: 10; margin-bottom: 10vh; width: 100%; display: flex; justify-content: center; }
.logo-svg { width: 35vw; height: auto; }

.intro-center { text-align: center; z-index: 10; display: flex; flex-direction: column; gap: 1vh; }
.meta { font-size: 5rem; line-height: 1; letter-spacing: 0.1rem; margin: 0; }
.mono { font-size: 2rem; color: rgba(255,255,255,0.6); font-weight: 300; letter-spacing: 0.4rem; text-transform: uppercase; margin: 0; }

.footer-intro { 
    position: absolute; bottom: 20vh; width: 100%; text-align: center; z-index: 50; 
}
.scan-effect {
    font-family: var(--font-mono); font-size: 1.5rem; letter-spacing: 0.4rem; font-weight: bold;
    color: var(--accent-color); text-transform: uppercase; cursor: pointer; pointer-events: all;
    animation: blink 2s infinite;
}
@keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

/* =========================================
   4. SCENA ISTRUZIONI
   ========================================= */
#scene-instructions { display: flex; align-items: center; justify-content: center; }
#scene-instructions .centered-text { display: flex; flex-direction: column; gap: 3vh; }
.instruct-line { 
    font-family: var(--font-hoves-light); font-size: 5rem; line-height: 1.7; 
    text-transform: uppercase; opacity: 0; margin: 0; text-align: center; 
}

/* =========================================
   5. SCENA CAROSELLO (Centrato Correttamente)
   ========================================= */
#scene-carousel { display: flex; flex-direction: column; justify-content: center; }

.carousel-title-box { text-align: center; z-index: 20; position: absolute; top: 15vh; width: 100%; }
.carousel-title-box h2 { font-family: var(--font-hoves); font-size: 2.5rem; font-weight: 300; letter-spacing: 0.2rem; margin: 0; text-transform: uppercase; }

.carousel-viewport { width: 100%; height: 100vh; display: flex; align-items: center; overflow: hidden; }
#carousel-track { display: flex; align-items: center; gap: 5vw; padding-left: 50vw; will-change: transform; }

.card {
    width: 60vw; height: auto; min-height: 50vh; flex-shrink: 0; padding: 4rem;
    background: rgba(10,10,10,0.9); border: 1px solid #333; border-radius: 1%;
    opacity: 0.3; transform: scale(0.9); filter: blur(3px) grayscale(100%);
    display: flex; flex-direction: column; justify-content: flex-start;
}
.card.active { opacity: 1; transform: scale(1); filter: blur(0) grayscale(0); border-color: #555; z-index: 10; }

.card-header-newspaper { display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 2px solid white; padding-bottom: 1.5rem; margin-bottom: 2rem; }
.newspaper-logo { height: 3rem; filter: invert(0); }
.newspaper-meta { font-family: var(--font-hoves); font-size: 0.9rem; color: #aaa; text-transform: uppercase; }
.newspaper-headline { font-family: 'Times New Roman', serif; font-size: 3.5rem; line-height: 1.1; margin-bottom: 2rem; margin-top: 0; }
.newspaper-body { font-family: var(--font-hoves); font-size: 1.3rem; line-height: 1.5; color: #ccc; text-align: justify; margin: 0; }

.carousel-footer { position: absolute; bottom: 5vh; width: 100%; display: flex; flex-direction: column; align-items: center; gap: 1rem; }
.knob-instruction { font-family: var(--font-mono); color: var(--accent-color); font-size: 1.5rem; letter-spacing: 0.2rem; }

/* =========================================
   SCENA 6: EDIT MODE (LAYOUT FIX DEFINITIVO)
   ========================================= */
#scene-edit {
    height: 110vh; /* Altezza fissa schermo */
    display: flex;
    flex-direction: column; /* Pila verticale */
    /* Padding per non finire sotto l'header o fuori schermo in basso */
    padding-top: 20vh; 
    padding-bottom: 2vh;
    box-sizing: border-box;
    overflow: hidden; /* Evita scrollbar indesiderate */
    background: radial-gradient(circle at center, #1a1a1a 0%, #000 90%);
}

/* --- PARTE ALTA: TESTO (Non si schiaccia) --- */
.edit-text-wrapper { 
    flex-shrink: 0; /* Impedisce che si rimpicciolisca */
    width: 80%; margin: 0 auto; text-align: left; z-index: 10; 
    padding-bottom: 2vh;
}
#edit-headline { font-family: var(--font-mono); font-size: 2rem; color: white; margin-bottom: 1vh; text-transform: uppercase; line-height: 1.1; }
.scrolling-body { max-height: 8vh; overflow-y: auto; padding-right: 1rem; border-left: 3px solid var(--accent-color); padding-left: 1rem;}
#edit-body { font-family: var(--font-mono); font-size: 1rem; color: #ccc; line-height: 1.4; margin: 0; }

/* --- PARTE CENTRALE: GRAFO (Si espande) --- */
#graph-container { 
    flex-grow: 1;    /* PUNTO CHIAVE: Occupa tutto lo spazio disponibile al centro */
    min-height: 0;   /* PUNTO CHIAVE: Permette al contenitore di restringersi se necessario */
    width: 100%; 
    display: flex; justify-content: center; align-items: center; /* Centra l'SVG al suo interno */
    position: relative; z-index: 1; overflow: visible;
    /* margin: 2vh 0; Spazio sopra e sotto opzionale */
}
svg { width: 95%; height: 95%; overflow: visible; } /* Un po' di margine interno */

/* Stili Grafo Luminosi */
.param-text { fill: #aaa; font-family: var(--font-hoves); font-size: 1.2rem; font-weight: regular;}
.macro-text { 
    fill: #ffffffd7; font-family: var(--font-hoves-medium); font-size: 1.4rem; 
    font-weight: 800; text-transform: uppercase; letter-spacing: 0.1rem;
    filter: drop-shadow(0 0 8px black); pointer-events: none;
}
.value-line { stroke: #fff; stroke-width: 3px; stroke-linecap: round; opacity: 0.9; filter: drop-shadow(0 0 5px white); }
.connection { fill: none; stroke: var(--accent-color); stroke-width: 2px; opacity: 0.8; filter: drop-shadow(0 0 8px var(--accent-color)); }

/* --- PARTE BASSA: FOOTER (Non si schiaccia) --- */
.edit-footer {
    flex-shrink: 0; /* Impedisce che si rimpicciolisca */
    width: 100%; 
    display: flex; flex-direction: column; align-items: center; justify-content: flex-end;
    z-index: 50;
}

/* Sliders */
.temp-controls {
    display: flex; gap: 2vw; background: rgba(15, 15, 15, 0.95); 
    padding: 1rem 2.5rem; border-radius: 50px; border: 1px solid #444;
    pointer-events: all; box-shadow: 0 0 30px rgba(0,0,0,0.5);
}
.slider-row { display: flex; flex-direction: column; align-items: center; gap: 0.3vh; }
.slider-row span { font-family: var(--font-mono); font-size: 0.7rem; color: var(--accent-color); font-weight: bold; }
.cyber-range { -webkit-appearance: none; width: 5vw; height: 4px; background: #333; border-radius: 2px; outline: none; cursor: pointer; }
.cyber-range::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: white; border: 2px solid var(--accent-color); border-radius: 50%; cursor: pointer; box-shadow: 0 0 5px var(--accent-color); }

/* Pedina (Mini Totem) con spazio adeguato */
.footer-decoration { 
    display: flex; flex-direction: column; align-items: center; 
    margin-top: 3vh; /* SPAZIO IMPORTANTE tra sliders e pedina */
    padding-bottom: 3vh;
}
.pedine-label { font-family: var(--font-mono); color: #666; font-size: 0.7rem; letter-spacing: 0.2rem; margin-bottom: 1vh; text-transform: uppercase; font-weight: bold; }
#mini-totem-container { width: 120px; height: 140px; position: relative; z-index: 101; filter: drop-shadow(0 0 20px rgba(255, 72, 36, 0.3)); }

/* =========================================
   SCENA 5: PROCESSING (STRIPES)
   ========================================= */
#scene-processing {
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    background: #000; overflow: hidden; position: relative; perspective: 1000px;
}
#stripes-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
.data-stripe {
    position: absolute; top: 50%; transform: translateY(-50%);
    width: 2px; background-color: var(--accent-color);
    box-shadow: 0 0 10px var(--accent-glow); opacity: 0.7;
}
.vignette-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, transparent 20%, black 95%); z-index: 1; pointer-events: none; }

.processing-container { position: relative; z-index: 10; text-align: center; width: 60vw; }
.system-msg {
    font-family: var(--font-mono); color: var(--accent-color); letter-spacing: 0.5rem; animation: pulse 0.2s infinite;
    font-size: 1.2rem; background: rgba(0,0,0,0.8); padding: 10px 20px; display: inline-block; margin-bottom: 3vh;
}
.card-ghost { border-left: 2px solid #fff; padding-left: 2rem; text-align: left; opacity: 0.9; }
#proc-headline { font-family: 'Times New Roman', serif; font-size: 2.5rem; color: white; margin-bottom: 1rem; margin-top: 0; }
#proc-body { font-family: var(--font-mono); font-size: 1rem; color: #ccc; margin: 0; }

/* =========================================
   SCENA IMPACT: DASHBOARD LAYOUT
   ========================================= */
#scene-impact {
    background: #050505;
    padding: 8vh 4vw 4vh 4vw; /* Spazio per header */
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    overflow-y: auto; /* Permetti scroll se schermi piccoli */
}

/* UI DECORATIONS */
.impact-header-ui {
    display: flex; justify-content: space-between;
    font-family: var(--font-mono); font-size: 0.6rem; color: #444;
    margin-bottom: 2vh; border-bottom: 1px solid #222; padding-bottom: 0.5rem;
}

/* NOTIZIA (Stile Giornale) */
.news-preview-container {
    margin-bottom: 3vh;
    padding-bottom: 3vh;
    border-bottom: 1px dashed #333;
}
.news-header { display: flex; align-items: flex-end; gap: 2rem; margin-bottom: 1rem; }
.news-logo-final { height: 2rem; filter: invert(1); }
.news-meta { font-family: var(--font-hoves); font-size: 0.8rem; color: #888; text-transform: uppercase; }
.news-headline { 
    font-family: 'Times New Roman', serif; font-size: 2.5rem; color: #eee; 
    line-height: 1.1; margin: 0 0 1rem 0; max-width: 90%;
}
.news-body { 
    font-family: 'Times New Roman', serif; font-size: 1.1rem; color: #aaa; 
    line-height: 1.4; max-width: 80%; 
}

/* DASHBOARD GRID SYSTEM */
.dashboard-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* 2 Colonne */
    gap: 2rem 4rem; /* Spazio tra le card */
    margin-bottom: 4vh;
}

.dash-card { display: flex; flex-direction: column; gap: 0.5rem; }
.dash-card.full-width { grid-column: 1 / -1; display: flex; flex-direction: column; align-items: center; }

.dash-label {
    font-family: var(--font-hoves); font-size: 0.7rem; color: #666; 
    text-transform: uppercase; border-bottom: 1px solid #333; padding-bottom: 0.2rem;
    display: block; width: 100%;
}

.viz-container {
    height: 120px; width: 100%; position: relative;
    display: flex; align-items: center;
}
.viz-container.center-flex { justify-content: center; }

/* SVG GENERICI */
.graph-svg { width: 100%; height: 100%; overflow: visible; }
.highlight-text { color: var(--accent-color); font-weight: bold; }

.data-readout {
    font-family: var(--font-mono); font-size: 0.7rem; color: #888;
    display: flex; flex-direction: column; gap: 0.2rem;
}
.dash-desc { font-family: var(--font-mono); font-size: 0.7rem; color: #888; line-height: 1.3; margin: 0; }
.dash-desc.center-text { text-align: center; }
.dash-desc .big-stat { font-size: 1.2rem; color: var(--accent-color); }

/* FOOTER */
.final-action-area {
    margin-top: auto; text-align: center; padding-top: 2rem;
}
.blink-warning {
    font-family: var(--font-hoves-bold); font-size: 1.5rem; color: #fff;
    margin-bottom: 1rem; text-transform: uppercase;
}
.scan-effect-btn {
    background: transparent; border: 1px solid #444; color: var(--accent-color);
    padding: 1rem 2rem; font-family: var(--font-mono); font-size: 1rem;
    letter-spacing: 0.2rem; cursor: pointer; text-transform: uppercase;
    transition: all 0.3s;
}
.scan-effect-btn:hover { background: rgba(255, 72, 36, 0.1); border-color: var(--accent-color); }
/* =========================================
   TEMPLATE CARDS: STILI SPECIFICI
   ========================================= */

/* --- 1. STILE CORRIERE (Classico) --- */
.card.is-corriere {
    background: rgba(10,10,10,0.9); /* Grigio molto scuro, quasi nero carta */
    border: 1px solid #444;
    padding: 3rem;
    text-align: center;
}
.corriere-header {
    display: flex; flex-direction: column; align-items: center; gap: 1rem;
    border-bottom: 1px solid white; width: 100%; padding-bottom: 2rem; margin-bottom: 1.5rem;
}
.corriere-logo { height: 3.5rem;}
.corriere-meta-row {
    font-family: var(--font-hoves); font-size: 0.7rem; color: #aaa; text-transform: uppercase;
    display: flex; gap: 31rem;
}
.corriere-headline {
    font-family: 'Times New Roman', serif; font-size: 2.8rem; line-height: 1.3;
    margin-bottom: 1rem; color: white; text-align: left;
}
.corriere-divider { width: 50px; height: 1px; background: #666; margin: 1.5rem 0; }
.corriere-body {
    font-family: 'Times New Roman', serif; font-size: 1.7rem; color: #ccc;
    text-align: justify; line-height: 1.5;
}
.corriere-footer {
    margin-top: auto; font-family: var(--font-hoves); font-size: 0.6rem; color: #666;
    text-transform: uppercase; align-self: flex-start;
    display: none;
}


/* --- 2. STILE SKY (Moderno/Broadcast) --- */
.card.is-sky {
    background: rgba(10,10,10,0.9);
    border: 1px solid #444;
    padding: 3rem;
    text-align: left;
}
.sky-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 1rem;
}
.sky-logo { height: 3rem; filter: invert(0); } /* Sky logo spesso è già bianco o colorato */
.sky-meta { font-family: var(--font-mono); font-size: 0.8rem; color: white; }
.sky-divider { width: 100%; height: 2px; background: white; margin-bottom: 2rem; }
.sky-headline {
    font-family: var(--font-hoves-bold); font-size: 2.7rem; text-transform: uppercase;
    line-height: 1.3; margin-bottom: 1.5rem; color: white;
}
.sky-body {
    font-family: var(--font-hoves); font-size: 1.8rem; color: #ddd; line-height: 1.5;
}


/* --- 3. STILE TWITTER (Social: Fedele allo Screenshot) --- */
.card.is-twitter {
    background: rgba(10,10,10,0.9); /* Nero assoluto come nello screen */
    border: 1px solid #444; /* Il grigio scuro specifico dei bordi di X */
    padding: 2rem 2.5rem; /* Padding bilanciato */
    display: flex;
    flex-direction: column;
}

/* HEADER: Avatar e Nome */
.twitter-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 1rem;
}

.twitter-avatar {
    width: 44px; 
    height: 44px;
    background-color: #eff3f4; /* Sfondo chiaro dell'icona placeholder */
    border-radius: 50%;
    
    /* --- AGGIUNTA: L'icona dell'omino --- */
    background-image: url('data:image/svg+xml;utf8,<svg fill="black" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>');
    background-position: center;
    background-repeat: no-repeat;
    background-size: 85%; /* Dimensione dell'omino dentro il cerchio */
    
    flex-shrink: 0;
}

/* Questa regola non serve più se usiamo il background-image, 
   ma la lascio per non rompere nulla nel caso tu abbia modificato l'HTML */
.twitter-avatar svg {
    display: none; 
}

.twitter-user-info { 
    display: flex; 
    flex-direction: column; 
    justify-content: center;
}

.twitter-name { 
    font-family: var(--font-hoves-bold); 
    font-weight: 500;
    font-size: 3rem; 
    color: #e7e9ea; 
    line-height: 1.2;
}

.twitter-handle { 
    font-family: var(--font-hoves); 
    font-size: 1.4rem; 
    color: #71767b; 
}

/* DATA */
.twitter-date { 
    display: none; 
}

/* CORPO DEL TESTO */
.twitter-content { 
    margin-bottom: 1.5rem; 
    flex-grow: 1; 
}

.twitter-body {
    font-family: var(--font-hoves); 
    font-size: 2.2rem; 
    color: #e7e9ea; 
    line-height: 1.5; 
    text-align: left; 
    margin-top: 2;
    white-space: pre-wrap; 
}

/* FOOTER */
.twitter-footer {
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    padding-top: 1rem; 
    border-top: 1px solid transparent; 
    margin-top: auto;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
}

.tw-icon { 
    width: 3rem; 
    height: 3em; 
    fill: #71767b; 
    transition: all 0.2s ease;
    cursor: pointer;
}

/* Hover effects */
.card.is-twitter:hover .tw-icon:nth-child(1):hover { fill: #1d9bf0; background: rgba(29,155,240,0.1); border-radius: 50%; } 
.card.is-twitter:hover .tw-icon:nth-child(2):hover { fill: #00ba7c; background: rgba(0,186,124,0.1); border-radius: 50%; } 
.card.is-twitter:hover .tw-icon:nth-child(3):hover { fill: #f91880; background: rgba(249,24,128,0.1); border-radius: 50%; }