/* =========================================
   1. SETUP BASE & VARIABILI
   ========================================= */
:root {
    --bg-color: #010101; /* Nero assoluto per contrasto */
    --accent-color: #ff340c;
    --accent-glow: rgba(255, 72, 36, 0.5);
    --glass-bg: rgba(10, 10, 10, 0.8);
    --glass-border: rgba(255, 255, 255, 0.15);
    
    --font-hoves: 'TTHoves-Regular', sans-serif;
    --font-hoves-bold: 'TTHoves-Bold', sans-serif;
    --font-mono: 'Input-Mono', monospace;
    --font-hoves-light:'TTHoves-Light', sans-serif;
}

@font-face { font-family: 'TTHoves-Regular'; src: url('../assets/fonts/TT Hoves Pro Trial Regular.ttf') format('truetype'); }
@font-face { font-family: 'TTHoves-Bold'; src: url('../assets/fonts/TT Hoves Pro Trial Bold.ttf') format('truetype'); }
@font-face { font-family: 'Input-Mono'; src: url('../assets/fonts/input.ttf') format('truetype'); }
@font-face { font-family: 'TTHoves-Light'; src: url('../assets/fonts/TT\ Hoves\ Pro\ Trial\ Light.ttf') format('truetype'); }

html { font-size: 1vw; } 

body {
    background-color: var(--bg-color); color: white;
    font-family: var(--font-hoves); height: 100vh; width: 100vw;
    overflow: hidden; margin: 0;
}

/* =========================================
   2. UI & HEADER
   ========================================= */
.scene {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    opacity: 0; visibility: hidden; z-index: 1;
    /* RIMOSSO IL FLEXBOX GLOBALE CHE ROMPEVA IL LAYOUT */
}
.scene.active { opacity: 1; visibility: visible; z-index: 10; pointer-events: all; }
.hidden { opacity: 0 !important; pointer-events: none !important; visibility: hidden !important; }

#global-header {
    position: fixed; top: 0; left: 0; width: 100%; height: 5%; padding: 0 4rem;
    display: flex; justify-content: space-between; align-items: center;
    z-index: 100; background: linear-gradient(to bottom, rgba(0,0,0,0.9) 0%, transparent 100%);
    pointer-events: none; transition: opacity 0.5s; box-sizing: border-box;
    border-bottom: 1px solid rgba(255, 255, 255, 0.678);
}
.header-left { flex: 1; display: flex; align-items: center; gap: 1rem; }
.header-center { flex: 1; text-align: center; font-size: 1.7rem; letter-spacing: 0.2rem;  }
.header-right { flex: 1; text-align: right; font-size: 1.7rem; letter-spacing: 0.2rem; }
.icon-f { font-size: 2rem; color: var(--accent-color); }
.header-logo-img { height: 1.7rem; width: auto; filter: invert(0); }

/* =========================================
   3. SCENA INTRO (Layout Originale Ripristinato)
   ========================================= */
#scene-intro { 
    display: flex; flex-direction: column; align-items: center; 
    padding-top: 12vh; /* Spazio preciso dall'alto */
}
#canvas-container-intro { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }

/* Il contenuto deve stare SOPRA il canvas 3D */
.intro-top { z-index: 10; margin-bottom: 10vh; width: 100%; display: flex; justify-content: center; }
.logo-svg { width: 35vw; height: auto; }

.intro-center { text-align: center; z-index: 10; display: flex; flex-direction: column; gap: 1vh; }
.meta { font-size: 5rem; line-height: 1; letter-spacing: 0.1rem; margin: 0; }
.mono { font-size: 2rem; color: rgba(255,255,255,0.6); font-weight: 300; letter-spacing: 0.4rem; text-transform: uppercase; margin: 0; }

.footer-intro { 
    position: absolute; bottom: 16vh; width: 100%; text-align: center; z-index: 50; font-size: 1.8rem; letter-spacing: 0.2rem;
}



.scan-effect {
    font-family: var(--font-mono); font-weight: bold;
    color: var(--accent-color); text-transform: uppercase; cursor: pointer; pointer-events: all;
    animation: blink 2s infinite;
}
@keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

/* =========================================
   4. SCENA ISTRUZIONI
   ========================================= */
#scene-instructions { display: flex; align-items: center; justify-content: center; }
#scene-instructions .centered-text { display: flex; flex-direction: column; gap: 3vh; }
.instruct-line { 
    font-family: var(--font-hoves-light); font-size: 5rem; line-height: 2.5; font-weight: 300;
    text-transform: uppercase; opacity: 0; margin: 0; text-align: center; 
}

/* =========================================
   5. SCENA CAROSELLO (Centrato Correttamente)
   ========================================= */
#scene-carousel { display: flex; flex-direction: column; justify-content: center; }

.carousel-title-box { text-align: center; z-index: 20; position: absolute; top: 15vh; width: 100%; }
.carousel-title-box h2 { font-family: var(--font-hoves); font-size: 2.5rem; font-weight: 300; letter-spacing: 0.2rem; margin: 0; text-transform: uppercase; }

.carousel-viewport { width: 100%; height: 100vh; display: flex; align-items: center; overflow: hidden; }
#carousel-track { display: flex; align-items: center; gap: 5vw; padding-left: 50vw; will-change: transform; }

.card {
    width: 60vw; height: auto; min-height: 50vh; flex-shrink: 0; padding: 4rem;
    background: rgba(10,10,10,0.9); border: 1px solid #333; border-radius: 0%;
    opacity: 0.3; transform: scale(0.9); filter: blur(3px) grayscale(100%);
    display: flex; flex-direction: column; justify-content: flex-start;
}
.card.active { opacity: 1; transform: scale(1); filter: blur(0) grayscale(0); border-color: #555; z-index: 10; }

.card-header-newspaper { display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 2px solid white; padding-bottom: 1.5rem; margin-bottom: 2rem; }
.newspaper-logo { height: 3rem; filter: invert(0); }
.newspaper-meta { font-family: var(--font-hoves); font-size: 0.9rem; color: #aaa; text-transform: uppercase; }
.newspaper-headline { font-family: 'Times New Roman', serif; font-size: 3.5rem; line-height: 1.1; margin-bottom: 2rem; margin-top: 0; }
.newspaper-body { font-family: var(--font-hoves); font-size: 1.3rem; line-height: 1.5; color: #ccc; text-align: justify; margin: 0; }

.carousel-footer { position: absolute; bottom: 4%; width: 100%; display: flex; flex-direction: column; align-items: center; }
.knob-instruction { font-family: var(--font-mono); color: var(--accent-color); font-size: 1.8rem; letter-spacing: 0.2rem; animation: blink 2s infinite; }

/* =========================================
   SCENA 6: EDIT MODE (LAYOUT FIX DEFINITIVO)
   ========================================= */
#scene-edit {
    position: relative; /* Ancora per gli elementi assoluti */
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    background: radial-gradient(circle at center, #1a1a1a 0%, #000 90%);
    /* Rimosso flex, flex-direction, padding, etc. */
}

/* --- PARTE ALTA: TESTO (Non si schiaccia) --- */
.edit-text-wrapper { 
    position: absolute; /* Fisso in alto */
    top: 58vh;
    left: 50%;
    transform: translateX(-50%);
    width: 80%; 
    text-align: left; 
    z-index: 10; /* Sopra il grafico */
}
#edit-headline { font-family: 'Input Mono'; font-weight: 400; font-size: 2rem; color: white; margin-bottom: 1vh; text-transform: uppercase; line-height: 1.3; }
.scrolling-body { max-height: none; overflow-y: auto;}
#edit-body { font-family: 'Input Mono'; font-weight: 200; font-size: 1.7rem; color: #ffffff; line-height: 1.4; margin: 0; padding-top: 2%;}

/* --- PARTE CENTRALE: GRAFO (Si espande) --- */
#graph-container {
    position: absolute; /* Svincolato dal flusso */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -75%); /* Centrato (leggermente su per bilanciare i footer) */
    width: 90vw;  /* Larghezza fissa */
    height: 70vh; /* Altezza fissa */
    z-index: 1;   /* Livello base */
    pointer-events: none; /* Così puoi cliccare sulle cose che ci finiscono sopra */
    display: flex; 
    justify-content: center; 
    align-items: center;
}
#graph-container svg {
    transform: rotate(150deg);
}
svg { width: 95%; height: 95%; overflow: visible;} /* Un po' di margine interno */

.knob-video {
    width: 50%;  /* Dimensione che vuoi a schermo (simile ai 70px dell'SVG) */
    height: auto; /* Mantiene le proporzioni */
    
    /* IL TRUCCO MAGICO: */
    /* 'screen' o 'lighten' rendono il nero trasparente e lasciano i colori chiari */
    
    
    /* Assicurati che l'utente non possa cliccarci sopra per metterlo in pausa */
    pointer-events: none; 
    
    display: block; /* Per centrarlo bene */
    margin: 0 auto; /* Se serve centrarlo orizzontalmente */
}

/* Stili Grafo Luminosi */
.param-text { 
    fill: #333; /* ERA #aaa -> LO CAMBIAMO IN SCURO DI DEFAULT */
    font-family: var(--font-hoves); 
    font-size: 1.1rem; 
    font-weight: regular;
    transition: fill 0.5s ease; /* Aggiungi questo per un effetto morbido */
}
.macro-text { 
    fill: #ffffffd7; font-family: var(--font-hoves-medium); font-size: 1.4rem; 
    font-weight: 800; text-transform: uppercase; letter-spacing: 0.1rem;
    filter: drop-shadow(0 0 8px black); pointer-events: none;
}
.value-line { stroke: #fff; stroke-width: 2px; opacity: 0.9; /*filter: drop-shadow(0 0 5px white); */}
.connection { fill: none; stroke: white; stroke-width: 1px; opacity: 0.6; /*filter: drop-shadow(0 0 8px var(--accent-color)); */}


/* --- PARTE BASSA: FOOTER (Non si schiaccia) --- */


/* Sliders */
.temp-controls {
    display: flex; gap: 2vw; background: rgba(15, 15, 15, 0.95); 
    padding: 1rem 2.5rem; border-radius: 50px; border: 1px solid #444;
    pointer-events: all; box-shadow: 0 0 30px rgba(0,0,0,0.5);
}
.slider-row { display: flex; flex-direction: column; align-items: center; gap: 0.3vh; }
.slider-row span { font-family: var(--font-mono); font-size: 0.7rem; color: var(--accent-color); font-weight: bold; }
.cyber-range { -webkit-appearance: none; width: 5vw; height: 4px; background: #333; border-radius: 2px; outline: none; cursor: pointer; }
.cyber-range::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: white; border: 2px solid var(--accent-color); border-radius: 50%; cursor: pointer; box-shadow: 0 0 5px var(--accent-color); }

/* Pedina (Mini Totem) con spazio adeguato */
#pedina{
    scale: 0.4;
    position: absolute;
}


#mini-totem-container { width: 120px; height: 140px; position: absolute; z-index: 101; filter: drop-shadow(0 0 20px rgba(255, 72, 36, 0.3));
                     }

/*spiegazione parametri modificati stile

/* --- STILI PER LA DESCRIZIONE DEL PARAMETRO --- */
#param-info-container {
    position: absolute;
    /* 50% è il centro esatto dello schermo. 
       72% lo sposta sotto il grafico, ma prima degli slider. 
       Aggiusta questo numero se serve (es. 65% o 75%) */
    top: 78%; 
    left: 50%;
    transform: translateX(-50%); /* Centra orizzontalmente */
    
    width: 60vw; /* Larghezza massima per evitare righe lunghissime */
    text-align: center;
    z-index: 20; /* Sopra al grafico se dovesse sovrapporsi */
    
    pointer-events: none; /* IMPORTANTE: Così se ci finisce il mouse sopra, puoi cliccare quello che c'è sotto */
    transition: opacity 0.3s ease;
    padding-bottom: 1%;
    display: none;
}

/* Quando è nascosto */
#param-info-container.hidden {
    opacity: 0;
    transform: translateX(-50%) translateY(10px); /* Piccolo effetto salita quando appare */
}

/* Stili del Testo */
#param-info-title {
    font-family: 'TT Hoves Pro Trial';
    font-size: 1.7rem;
    font-weight: 400;
    color: white; /* Arancione Sci-Fi */
    text-transform: uppercase;
    letter-spacing: 0.2rem;
    text-shadow: 0 0 10px rgba(255, 72, 36, 0.3); /* Leggero glow */
}

#param-info-desc {
    font-family: 'TT Hoves Pro Trial'; /* Font tecnico */
    font-size: 1.5rem;
    font-weight: 200;
    color: rgba(255, 255, 255, 0.7);
    margin: 0;
    line-height: 1.4;
    background: rgba(0, 0, 0, 0.6); /* Sfondo semitrasparente per leggere meglio sopra le righe del grafico */
    border-radius: 4px;
    display: inline-block; /* Il box nero si adatta al testo */
    letter-spacing: 0.2rem;
}

/* =========================================
   SCENA 5: PROCESSING (STRIPES)
   ========================================= */
#scene-processing {
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    background: #000; overflow: hidden; position: relative; perspective: 1000px;
}
#stripes-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
.data-stripe {
    position: absolute; top: 50%; transform: translateY(-50%);
    width: 2px; background-color: var(--accent-color);
    box-shadow: 0 0 10px var(--accent-glow); opacity: 0.7;
}
.vignette-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, transparent 20%, black 95%); z-index: 1; pointer-events: none; }

.processing-container { position: relative; z-index: 10; text-align: center; width: 60vw; }
.system-msg {
    font-family: var(--font-mono); color: var(--accent-color); letter-spacing: 0.5rem; animation: pulse 0.2s infinite;
    font-size: 1.2rem; background: rgba(0,0,0,0.8); padding: 10px 20px; display: inline-block; margin-bottom: 3vh;
}
.card-ghost { border-left: 2px solid #fff; padding-left: 2rem; text-align: left; opacity: 0.9; }
#proc-headline { font-family: 'Times New Roman', serif; font-size: 2.5rem; color: white; margin-bottom: 1rem; margin-top: 0; }
#proc-body { font-family: var(--font-mono); font-size: 1rem; color: #ccc; margin: 0; }

/* =========================================
   SCENA IMPACT: DASHBOARD LAYOUT
   ========================================= */
#scene-impact {
    background: #050505;
    padding: 8vh 4vw 4vh 4vw; /* Spazio per header */
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    overflow-y: auto; /* Permetti scroll se schermi piccoli */
}

/* UI DECORATIONS */
.impact-header-ui {
    display: flex; justify-content: space-between;
    font-family: var(--font-mono); font-size: 0.6rem; color: #444;
    margin-bottom: 2vh; border-bottom: 1px solid #222; padding-bottom: 0.5rem;
}

/* NOTIZIA (Stile Giornale) */
.news-preview-container {
    margin-bottom: 3vh;
    padding-bottom: 3vh;
    border-bottom: 1px dashed #333;
}
.news-header { display: flex; align-items: flex-end; gap: 2rem; margin-bottom: 1rem; }
.news-logo-final { height: 2rem; filter: invert(1); }
.news-meta { font-family: var(--font-hoves); font-size: 0.8rem; color: #888; text-transform: uppercase; }
.news-headline { 
    font-family: 'Times New Roman', serif; font-size: 2.5rem; color: #eee; 
    line-height: 1.1; margin: 0 0 1rem 0; max-width: 90%;
}
.news-body { 
    font-family: 'Times New Roman', serif; font-size: 1.1rem; color: #aaa; 
    line-height: 1.4; max-width: 80%; 
}

/* DASHBOARD GRID SYSTEM */
.dashboard-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* 2 Colonne */
    gap: 2rem 4rem; /* Spazio tra le card */
    margin-bottom: 4vh;
}

.dash-card { display: flex; flex-direction: column; gap: 0.5rem; }
.dash-card.full-width { grid-column: 1 / -1; display: flex; flex-direction: column; align-items: center; }

.dash-label {
    font-family: var(--font-hoves); font-size: 0.7rem; color: #666; 
    text-transform: uppercase; border-bottom: 1px solid #333; padding-bottom: 0.2rem;
    display: block; width: 100%;
}

.viz-container {
    height: 120px; width: 100%; position: relative;
    display: flex; align-items: center;
}
.viz-container.center-flex { justify-content: center; }

/* SVG GENERICI */
.graph-svg { width: 100%; height: 100%; overflow: visible; }
.highlight-text { color: var(--accent-color); font-weight: bold; }

.data-readout {
    font-family: var(--font-mono); font-size: 0.7rem; color: #888;
    display: flex; flex-direction: column; gap: 0.2rem;
}
.dash-desc { font-family: var(--font-mono); font-size: 0.7rem; color: #888; line-height: 1.3; margin: 0; }
.dash-desc.center-text { text-align: center; }
.dash-desc .big-stat { font-size: 1.2rem; color: var(--accent-color); }

/* FOOTER */
.final-action-area {
    margin-top: auto; text-align: center; padding-top: 2rem;
}
.blink-warning {
    font-family: var(--font-hoves-bold); font-size: 1.8rem; color: #fff;
    bottom: 1rem; text-transform: uppercase;
}
.scan-effect-btn {
    background: transparent; border: 1px solid #444; color: var(--accent-color);
    padding: 1rem 2rem; font-family: var(--font-mono); font-size: 1rem;
    letter-spacing: 0.2rem; cursor: pointer; text-transform: uppercase;
    transition: all 0.3s;
}
.scan-effect-btn:hover { background: rgba(255, 72, 36, 0.1); border-color: var(--accent-color); }
/* =========================================
   TEMPLATE CARDS: STILI SPECIFICI
   ========================================= */

/* --- 1. STILE CORRIERE (Classico) --- */
.card.is-corriere {
    background: rgba(10,10,10,0.9); /* Grigio molto scuro, quasi nero carta */
    border: 1px solid #444;
    padding: 3rem;
    text-align: center;
}
.corriere-header {
    display: flex; flex-direction: column; align-items: center; gap: 1rem;
    border-bottom: 0.6px solid white; width: 100%; padding-bottom: 2rem; margin-bottom: 1.5rem;
}
.corriere-logo { height: 3rem;}
.corriere-meta-row {
    font-family: var(--font-hoves); font-size: 1rem; color: #aaa; text-transform: none;
    display: flex; gap: 23rem;
}
.corriere-headline {
    font-family: 'Times New Roman', serif; font-size: 2.8rem; line-height: 1.3;
    margin-bottom: 1rem; color: white; text-align: left;
}
.corriere-divider { width: 50px; height: 1px; background: #666; margin: 1.5rem 0; }
.corriere-body {
    font-family: 'Times New Roman', serif; font-size: 1.7rem; color: #ccc;
    text-align: justify; line-height: 1.5;
}
.corriere-footer {
    margin-top: auto; font-family: var(--font-hoves); font-size: 0.6rem; color: #666;
    text-transform: uppercase; align-self: flex-start;
    display: none;
}


/* --- 2. STILE SKY (Moderno/Broadcast) --- */
.card.is-sky {
    background: rgba(10,10,10,0.9);
    border: 1px solid #444;
    padding: 3rem;
    text-align: left;
}
.sky-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 1rem;
}
.sky-logo { height: 2.5rem; filter: invert(0); } /* Sky logo spesso è già bianco o colorato */
.sky-meta { font-family: var(--font-mono); font-size: 1rem; color: white; }
.sky-divider { width: 100%; height: 0.6px; background: white; margin-bottom: 2rem; margin-top: 2rem;}
.sky-headline {
    font-family: 'TT Hoves Pro Trial'; font-size: 2.7rem; text-transform: none;
    line-height: 1.3; margin-bottom: 1.5rem; color: white; font-weight: 500;
}
.sky-body {
    font-family: var(--font-hoves); font-size: 1.8rem; color: #ddd; line-height: 1.5;
}


/* --- 3. STILE TWITTER (Social: Fedele allo Screenshot) --- */
.card.is-twitter {
    background: rgba(10,10,10,0.9); /* Nero assoluto come nello screen */
    border: 1px solid #444; /* Il grigio scuro specifico dei bordi di X */
    padding: 2rem 2.5rem; /* Padding bilanciato */
    display: flex;
    flex-direction: column;
}

/* HEADER: Avatar e Nome */
.twitter-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 1rem;
}

.twitter-avatar {
    width: 44px; 
    height: 44px;
    background-color: #eff3f4; /* Sfondo chiaro dell'icona placeholder */
    border-radius: 50%;
    
    /* --- AGGIUNTA: L'icona dell'omino --- */
    background-image: url('data:image/svg+xml;utf8,<svg fill="black" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>');
    background-position: center;
    background-repeat: no-repeat;
    background-size: 85%; /* Dimensione dell'omino dentro il cerchio */
    
    flex-shrink: 0;
}

/* Questa regola non serve più se usiamo il background-image, 
   ma la lascio per non rompere nulla nel caso tu abbia modificato l'HTML */
.twitter-avatar svg {
    display: none; 
}

.twitter-user-info { 
    display: flex; 
    flex-direction: column; 
    justify-content: center;
}

.twitter-name { 
    font-family: TT Hoves Pro Trial; 
    font-weight: 600;
    font-size: 2rem; 
    color: #e7e9ea; 
    line-height: 1.2;;
}

.twitter-handle { 
    font-family: var(--font-hoves); 
    font-size: 1.4rem; 
    color: #71767b; 
}
.twitter-verified-badge {
    width: 20px; height: 20px; flex-shrink: 0; margin-top: 2px;
}
/* DATA */
.twitter-date { 
    display: none; 
}

/* CORPO DEL TESTO */
.twitter-content { 
    margin-bottom: 1.5rem; 
    flex-grow: 1; 
}

.twitter-body {
    font-family: var(--font-hoves); 
    font-size: 2.2rem; 
    color: #e7e9ea; 
    line-height: 1.5; 
    text-align: left; 
    margin-top: 2;
    white-space: pre-wrap; 
}

/* FOOTER */
.twitter-footer {
    display: flex !important; /* FORZIAMO IL FLEX */
    justify-content: space-between; /* Spinge le icone agli estremi */
    align-items: center;
    width: 100%; /* Occupa tutto lo spazio meno il margine */
    
    padding-top: 1rem; 
    margin-top: auto;
    position: relative; z-index: 2;
}

.tw-icon { 
    width: 3rem; 
    height: 3em; 
    fill: #71767b; 
    transition: all 0.2s ease;
    cursor: pointer;
}

/* Hover effects */
.card.is-twitter:hover .tw-icon:nth-child(1):hover { fill: #1d9bf0; background: rgba(29,155,240,0.1); border-radius: 50%; } 
.card.is-twitter:hover .tw-icon:nth-child(2):hover { fill: #00ba7c; background: rgba(0,186,124,0.1); border-radius: 50%; } 
.card.is-twitter:hover .tw-icon:nth-child(3):hover { fill: #f91880; background: rgba(249,24,128,0.1); border-radius: 50%; }

/* Aggiungi questo alla fine del CSS */

/* Stato quando la GUI è nascosta */
.gui-hidden , 
.gui-hidden .temp-controls {
    opacity: 0;
    transform: translateY(50px); /* Scivola giù */
    pointer-events: none; /* Disattiva i click quando invisibile */
}

/* Assicuriamoci che la transizione sia fluida sull'elemento originale */
.edit-footer {
    transition: opacity 0.5s ease, transform 0.5s ease;
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    padding-bottom: 3vh; /* Spazio dal bordo inferiore */
    z-index: 30;
    pointer-events: none; /* Lascia passare i click, riabilitiamo sugli elementi figli */
    transition: opacity 0.5s ease;

}

/* =========================================
   SCENA IMPACT V2 - STILE SCREENSHOT
   ========================================= */
#scene-impact-v2 {
    background-color: #000;
    padding: 2vh 4vw;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    overflow-y: auto; /* Permette scroll se necessario */
    color: #fff;
}

.impact-hero {
    position: fixed;
    top: 8vh;
    left: 50%;
    transform: translateX(-50%);
    z-index: 50;
    pointer-events: none;
    width: min(80vw, 1000px);
    display: flex;
    justify-content: center;
}

.impact-hero img {
    width: 100%;
    max-height: 40vh;
    object-fit: cover;
    border: 1px solid #222;
    box-shadow: 0 12px 36px rgba(0, 0, 0, 0.55);
}

.impact-hero-note {
    position: absolute;
    bottom: 300px;
    left: 50%;
    transform: translateX(-50%);
    font-family: var(--font-hoves);
    font-size: 4rem;
    font-weight: 600;
    color: #fff;
    letter-spacing: 0.02em;
    pointer-events: none;
}

.impact-hero-close {
    position: absolute;
    top: -14px;
    right: -14px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: 1px solid #444;
    background: rgba(0,0,0,0.75);
    color: #fff;
    font-size: 1rem;
    cursor: pointer;
    pointer-events: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.impact-hero-close:hover { background: rgba(255,52,12,0.85); transform: scale(1.05); }
.impact-hero-close:active { transform: scale(0.97); }

.hidden-banner { display: none; }

/* Header & Divider */
.impact-v2-header { text-align: center; margin-bottom: 2vh; }
.v2-subtitle { font-family: var(--font-hoves); font-size: 0.8rem; color: #888; letter-spacing: 0.2rem; text-transform: uppercase; }

.impact-divider {
    text-align: center; font-family: var(--font-hoves); font-size: 1.2rem; 
    letter-spacing: 0.2rem; color: #fff; margin: 3vh 0; text-transform: uppercase;
}

/* Articolo Box */
/* --- FIX CARD FINALE (TESTO TAGLIATO) --- */
.final-article-box {
    border: 1px solid #333;
    padding: 2rem; /* Spazio interno */
    background: #080808;
    margin-top: 3vh;
    max-height: 45vh; /* Un po' più alto */
    overflow-y: auto;
    overflow-x: hidden; /* Vietato scroll orizzontale */
}

/* Forziamo la card clonata a comportarsi bene */
.final-article-box .card {
    width: 100% !important;
    height: auto !important;
    transform: none !important; /* Rimuove rotazioni o scale residue */
    opacity: 1 !important;
    filter: none !important;
    background: transparent !important;
    border: none !important;
    padding:0;
    margin-top: 1vh !important;
}

/* Testo che va a capo correttamente */
.final-article-box .corriere-headline,
.final-article-box .sky-headline,
.final-article-box .twitter-body {
    white-space: normal !important;
    word-wrap: break-word !important;
    max-width: 100% !important;
}

/* --- FIX TITOLI (PIÙ GRANDI E VISIBILI) --- */
.card-title {
    font-family: 'TTHoves-Regular', sans-serif; /* Font più pulito */
    font-size: 2.2rem; /* Molto più grande */
    font-weight: 400;
    color: #fff; 
    margin-bottom: 0.2rem; 
    text-transform: uppercase;
    line-height: 1;
    border: none; /* Rimosso bordo laterale se c'era */
    padding-left: 0;
}

.card-subtitle {
    font-family: 'Input-Mono', monospace; 
    font-size: 0.9rem; 
    color: #666; 
    /* Margine ridotto drasticamente per avvicinare il grafico */
    margin-bottom: 0.5rem !important; 
    margin-top: 0.2rem;
    text-transform: uppercase; 
    letter-spacing: 0.05rem;
    padding-left: 0;
}

/* --- ETICHETTE PER I GRAFICI (LABEL ASSI) --- */
.chart-overlay-label {
    white-space: pre; /* Rispetta i \n */
    font-weight: bold;
}

/* Griglia */
.impact-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 2vh;
}

.impact-card {
    border: 1px solid #333;
    background: #050505;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
}

.impact-card.full-width {
    grid-column: 1 / -1;
}

/* Tipografia Card */
card-footer-text {
    font-family: 'TTHoves-Regular', sans-serif; 
    font-size: 1rem;          
    color: #999;                 
    margin-top: auto; /* Spinge in basso */
    line-height: 1.4;            
    border-top: none; /* Rimosso bordo superiore */
    padding-top: 1rem;
    max-width: 90%;
}

.analysis-p {
    font-family: var(--font-hoves); 
    font-size: 1rem;             /* Più grande */
    color: #ddd;                 /* Più luminoso */
    margin-top: 2rem; 
    line-height: 1.6;
    background: rgba(255, 255, 255, 0.05); /* Sfondo leggero per staccare */
    padding: 1rem;
    border-radius: 4px;
    border-left: 2px solid var(--accent-color);
}
.highlight { color: var(--accent-color); font-weight: bold; }

/* Canvas Container per Three.js */
.canvas-3d-container {
    width: 100%;
    height: 250px; /* Altezza fissa per i grafici */
    position: relative;
    overflow: hidden;
    /* border: 1px dashed #222; Debug area */
}
.canvas-3d-container.big {
    height: 350px;
}

/* Layout specifico Card Cubo */
.card-layout-row { display: flex; gap: 2rem; align-items: center; }
.text-col {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding-right: 2rem;
}
.stat-row { 
    display: flex; 
    justify-content: space-between; /* Spinge nome a sx e valore a dx */
    align-items: center;
    font-family: 'TTHoves-Regular', sans-serif; 
    font-size: 1rem; 
    border-bottom: 1px solid #222; /* Riga sottile separatrice */
    padding: 1.2rem 0; 
    color: #ccc;
}
.stat-label-main {
    font-size: 1.1rem;
    color: #eee;
    display: block;
    margin-bottom: 0.2rem;
}
.stat-label-sub {
    font-family: 'Input-Mono', monospace;
    font-size: 0.7rem;
    color: #666;
    text-transform: uppercase;
}

.stat-val { 
    font-family: 'Input-Mono', monospace;
    font-weight: bold; 
    font-size: 0.9rem;
    text-transform: uppercase;
}
.stat-val.low, .stat-val.med, .stat-val.high { 
    color: var(--accent-color); /* Sempre arancione/rosso come da foto */
}
.analysis-p {
    font-family: var(--font-hoves); font-size: 0.9rem; color: #888; margin-top: 2rem; line-height: 1.4;
}

/* Footer */
.v2-footer { margin-top: auto; text-align: center; padding: 2rem 0; }
.blink-warning { animation: blink 2s infinite; color: var(--accent-color); font-family: var(--font-mono); margin-bottom: 1rem;}

/* Nascondi vecchia scena impact */
#scene-impact { display: none !important; }


/* =========================================
   SCENA PRE-EDIT (LAYOUT 50/50)
   ========================================= */
#scene-pre-edit {
    display: flex;
    flex-direction: column;
    justify-content: center; /* Centra tutto verticalmente */
    align-items: center;     /* Centra tutto orizzontalmente */
    height: 100vh;
    width: 100vw;
    background: var(--bg-color);
    overflow: hidden;
}

pre-edit-text-wrapper {
    text-align: center; /* <--- FONDAMENTALE PER CENTRARE IL TESTO */
    max-width: 60%;     /* Controlla la larghezza della colonna di testo */
    display: flex;
    flex-direction: column;
    align-items: center; /* Centra i figli flex */
    gap: 1rem;
    margin-top: -2vh; 
}

/* --- PARTE ALTA (VISUAL) --- */
.pre-edit-visual {
    width: 100%;
    height: auto; /* Altezza automatica */
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0;
    padding: 0;
}

/* --- CSS PER LA GIF ISTRUZIONI --- */
.instruct-gif {
    /* Riduciamo la dimensione della GIF per far stare tutto */
    width: auto;
    height: 25vh; 
    margin-top: 0;
    object-fit: contain;
}
/* Verifica che il contenitore padre abbia queste regole (dovrebbe già averle) */
.pre-edit-visual {
    height: 35vh;
    width: 100%;
    display: flex;
    justify-content: center; /* Centra orizzontalmente */
    align-items: center;     /* Centra verticalmente *     /* Sfondo scuro sotto la gif */
    overflow: hidden;        /* Taglia eventuali sbordature */
}
.pre-edit-title-gif {
    font-family: var(--font-hoves-medium);
    font-size: 2rem;
    letter-spacing: 0.1rem;
    margin: 0;
    padding: 0;
    position: static;
    margin-bottom: 1.2rem;
}
.pre-edit-body-gif {
    font-family: var(--font-hoves); /* O medium se preferisci più spesso */
    font-size: 1.8rem; 
    color: #ccc;
    line-height: 1.4;
    margin: 0;
    padding: 0;
    position: static;
    
    /* Forza la centratura del testo multiriga */
    text-align: center; 
    width: 60%;
    max-width: 100%; /* Si adatta al wrapper */
}


/* --- PARTE BASSA (CONTENT) --- */
.pre-edit-content {
    width: 80%; /* Più stretto per centrare meglio */
    height: auto;
    display: grid;
    grid-template-columns: 1fr 1fr; /* 2 Colonne */
    gap: 4rem 8rem; /* Spazio: Verticale Orizzontale */
    padding: 0;
    margin-bottom: 4vh; /* Spazio per il footer */
}

/* BOX SINGOLO PARAMETRO */
.param-row {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    text-align: left;
}

.param-row h4 {
    font-family: var(--font-hoves);
    font-size: 1.8rem; /* Un po' più compatti */
    margin: 0 0 0.8rem 0;
    letter-spacing: 0.1rem;
    text-transform: uppercase;
}

.param-row p {
    font-family: var(--font-hoves);
    color: #ccc;
    font-size: 1.6rem; 
    line-height: 1.4;
    margin: 0;
    max-width: 100%;
}

/* Footer Action */
.pre-edit-footer {
    position: absolute;
    bottom: 4.5%;
    width: 100%;
    text-align: center;
    pointer-events: none;
}


/* =========================================
   CAROSELLO IMPACT 2.0 (SLIDING + PROGRESS)
   ========================================= */

.impact-carousel-wrapper {
    position: relative;
    width: 100%;
    height: 60vh; /* Leggermente più alto per i testi più lunghi */
    border: 1px solid #333;
    background: #050505;
    overflow: hidden;
    margin-bottom: 2vh;
}

.impact-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    padding: 2rem 4rem;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    background: #050505;
    z-index: 1;
    
    /* LOGICA SCORRIMENTO */
    transition: transform 0.8s cubic-bezier(0.25, 1, 0.5, 1); /* Easing fluido */
    transform: translateX(100%); /* Default: Fuori a destra */
}

/* Slide Attiva: Al centro */
.impact-slide.active {
    transform: translateX(0%);
    z-index: 10;
}

/* Slide Precedente: Fuori a sinistra */
.impact-slide.prev {
    transform: translateX(-100%);
    z-index: 5;
}

/* Slide Header & Footer */
.slide-header {
    /* Riduciamo il padding inferiore dell'header della slide */
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid #222;
    margin-bottom: 0.5rem !important;
    flex-shrink: 0;
}

.card-title {
    font-size: 2.2rem; /* Ancora più grande */
    margin-bottom: 0.5rem;
}

.card-footer-text.carousel-mode {
    margin-top: auto;
    font-size: 1.3rem; /* Ingrandito */
    line-height: 1.5;
    color: #ccc;
    max-width: 90%;
}

/* Canvas Container */
.canvas-3d-container.carousel-mode {
    width: 100%;
    flex-grow: 1;
    /* CAMBIATO DA auto A 100% */
    height: 100% !important; 
    min-height: 300px !important; /* Sicurezza: altezza minima garantita */
    border: none;
    background: radial-gradient(circle at center, #111 0%, #000 80%);
}

/* Regola specifica per il grafico 3 (Sfere) che ha la classe .big */
.canvas-3d-container.carousel-mode.big {
    /* Più spazio per le etichette che escono */
    overflow: visible !important; 
}
/* --- SLIDE 3 SPECIFIC (SFERE) --- */
.slide-content-row {
    display: flex;
    width: 100%;
    height: 100%; /* Fondamentale */
    min-height: 400px; /* Fondamentale */
    gap: 4rem;
    align-items: center;
}

/* Lista pulita senza box strani */
.stats-sidebar-clean {
    width: 35%;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 1.5rem; /* Spazio tra le righe */
}

.stat-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #333;
    padding-bottom: 0.5rem;
}

.stat-label {
    font-family: var(--font-hoves);
    font-size: 1.1rem; /* Più leggibile */
    color: #aaa;
    text-transform: uppercase;
}

.stat-val {
    font-family: var(--font-mono);
    font-size: 1.1rem;
    font-weight: bold;
}
/* Colori valori */
.stat-val.low { color: #888; }
.stat-val.med { color: #ff340c; }
.stat-val.high { color: #ff340c; text-shadow: 0 0 5px #ff340c; }


/* --- BARRA DI PROGRESSO --- */
.carousel-progress-container {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 4px; /* Molto sottile */
    background: #222;
    z-index: 20;
}

.carousel-progress-bar {
    height: 100%;
    background: #ffffff; /* Bianco puro */
    width: 0%;
}

/* Animazione definita nel CSS, controllata da JS che resetta la classe */
.carousel-progress-bar.animating {
    animation: fillProgress 10s linear forwards;
}

@keyframes fillProgress {
    from { width: 0%; }
    to { width: 100%; }
}


/* 1. Nascondi la foto "Lavori in corso" */
#impact-hero {
    display: none !important;
}

/* 2. Riduci margini sottotitoli */
.card-subtitle {
    margin-bottom: 0.5rem !important; 
    margin-top: 0.2rem;
}
.slide-header {
    padding-bottom: 0.5rem !important;
    margin-bottom: 0.5rem !important;
}

/* 3. Ingrandisci valori statistiche e lista pulita */
.stat-val {
    font-size: 1.2rem !important; /* Più grandi */
    letter-spacing: 0.05rem;
}
.stat-label {
    font-size: 1rem !important;
    color: #bbb; /* Più chiari */
}

/* 4. Fix altezza grafici per evitare il problema "nero" */
.canvas-3d-container.carousel-mode {
    height: 100% !important;
    min-height: 350px !important;
} 

/* =========================================
   ISTRUZIONI EDIT MODE (AGGIORNAMENTO)
   ========================================= */

/* Posizionamento delle istruzioni laterali */
.edit-side-instruction {
    position: absolute;
    /* Invece di top: 50%, usiamo bottom per allinearle al footer */
    bottom: 5vh; 
    
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 35;
    transition: opacity 0.5s ease;
    text-align: center;
    
    /* Stessa altezza del blocco centrale per allineamento perfetto */
    height: 120px; 
    justify-content: flex-end;
}

.edit-side-instruction.left {
    left: 27%; 
    transform: translateX(-50%);
}

.edit-side-instruction.right {
    right: 26%; 
    transform: translateX(50%);
}

/* Classe per nascondere (con transizione) */
.hidden-inst {
    opacity: 0;
    pointer-events: none;
}

/* Icona video ridimensionata per i lati */
.knob-icon-small {
    height: auto;
    margin-bottom: 0.5rem;
}

.knob-instruction.small {
    font-family: var(--font-mono);
    font-size: 1.8rem; 
    color: var(--accent-color);
    letter-spacing: 0.1rem;
    max-width: 80%;
    margin: 0;
    text-shadow: 0 0 5px rgba(0,0,0,0.8); /* Leggibilità sopra il grafico */
    
    /* Effetto Blink anche qui per coerenza */
    animation: blink 2s infinite;
}

/* Contenitore footer edit pulito */
.edit-initial-instruction {
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: opacity 0.5s ease;
    pointer-events: all;
    height: 120px; /* Riserviamo lo spazio fisso per evitare salti */
    justify-content: flex-end;
    margin-bottom: 1vh;
}

